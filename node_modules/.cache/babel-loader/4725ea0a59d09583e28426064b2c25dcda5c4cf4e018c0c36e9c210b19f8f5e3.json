{"ast":null,"code":"import React,{useEffect,useState,useRef}from\"react\";import{useNavigate}from\"react-router-dom\";import\"./Notification.css\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const Notification=()=>{const[appointments,setAppointments]=useState([]);const[isOpen,setIsOpen]=useState(false);const navigate=useNavigate();const popupRef=useRef(null);useEffect(()=>{const storedEmail=sessionStorage.getItem(\"email\");if(!storedEmail)return;const fetchAppointments=async()=>{try{const res=await fetch(\"\".concat(process.env.REACT_APP_API_BASE_URL,\"/appointments\"));const data=await res.json();const userAppointments=data.filter(appt=>{var _appt$email;return((_appt$email=appt.email)===null||_appt$email===void 0?void 0:_appt$email.toLowerCase())===storedEmail.toLowerCase()&&appt.status!==\"completed\";});setAppointments(userAppointments);}catch(err){console.error(\"Error fetching appointments:\",err);}};fetchAppointments();},[]);const formatAppointmentTime=appt=>{if(appt.type===\"normal\"&&appt.date&&appt.selectedSlot){return\"\".concat(appt.date,\", \").concat(appt.selectedSlot);}else if(appt.timeSlot){const date=new Date(appt.timeSlot);const yyyy=date.getFullYear();const mm=String(date.getMonth()+1).padStart(2,\"0\");const dd=String(date.getDate()).padStart(2,\"0\");let hours=date.getHours();const minutes=String(date.getMinutes()).padStart(2,\"0\");const ampm=hours>=12?\"PM\":\"AM\";hours=hours%12;hours=hours===0?12:hours;const hh=String(hours).padStart(2,\"0\");return\"\".concat(yyyy,\"-\").concat(mm,\"-\").concat(dd,\", \").concat(hh,\":\").concat(minutes,\" \").concat(ampm);}return\"-\";};const handleClickOutside=e=>{if(popupRef.current&&!popupRef.current.contains(e.target)){setIsOpen(false);}};useEffect(()=>{document.addEventListener(\"mousedown\",handleClickOutside);return()=>document.removeEventListener(\"mousedown\",handleClickOutside);},[]);const handleToggle=()=>{setIsOpen(prev=>!prev);};const handleViewAll=()=>{navigate(\"/my-appointments\");};return/*#__PURE__*/_jsxs(\"div\",{className:\"floating-container\",ref:popupRef,children:[/*#__PURE__*/_jsx(\"div\",{className:\"floating-dot\",title:\"View Appointments\",onClick:handleToggle}),isOpen&&/*#__PURE__*/_jsxs(\"div\",{className:\"popup-notification\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Upcoming Appointments\"}),appointments.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"no-appointments\",children:\"You have no upcoming appointments.\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[appointments.slice(0,2).map((appt,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"appointment-item\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Doctor:\"}),\" \",appt.doctorName]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Speciality:\"}),\" \",appt.doctorSpeciality]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Name:\"}),\" \",appt.name]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Phone:\"}),\" \",appt.phoneNumber]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Time:\"}),\" \",formatAppointmentTime(appt)]}),index<Math.min(1,appointments.length-1)&&/*#__PURE__*/_jsx(\"hr\",{})]},index)),appointments.length>2&&/*#__PURE__*/_jsx(\"div\",{className:\"view-more\",children:/*#__PURE__*/_jsx(\"button\",{className:\"view-all-btn\",onClick:handleViewAll,children:\"View All\"})})]})]})]});};export default Notification;","map":{"version":3,"names":["React","useEffect","useState","useRef","useNavigate","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Notification","appointments","setAppointments","isOpen","setIsOpen","navigate","popupRef","storedEmail","sessionStorage","getItem","fetchAppointments","res","fetch","concat","process","env","REACT_APP_API_BASE_URL","data","json","userAppointments","filter","appt","_appt$email","email","toLowerCase","status","err","console","error","formatAppointmentTime","type","date","selectedSlot","timeSlot","Date","yyyy","getFullYear","mm","String","getMonth","padStart","dd","getDate","hours","getHours","minutes","getMinutes","ampm","hh","handleClickOutside","e","current","contains","target","document","addEventListener","removeEventListener","handleToggle","prev","handleViewAll","className","ref","children","title","onClick","length","slice","map","index","doctorName","doctorSpeciality","name","phoneNumber","Math","min"],"sources":["C:/Page/Projects/Projects/MSCHealth/src/Components/Notification/Notification.jsx"],"sourcesContent":["import React, { useEffect, useState, useRef } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport \"./Notification.css\";\r\n\r\nconst Notification = () => {\r\n  const [appointments, setAppointments] = useState([]);\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const navigate = useNavigate();\r\n  const popupRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    const storedEmail = sessionStorage.getItem(\"email\");\r\n    if (!storedEmail) return;\r\n\r\n    const fetchAppointments = async () => {\r\n      try {\r\n        const res = await fetch(\r\n          `${process.env.REACT_APP_API_BASE_URL}/appointments`\r\n        );\r\n        const data = await res.json();\r\n\r\n        const userAppointments = data.filter(\r\n          (appt) =>\r\n            appt.email?.toLowerCase() === storedEmail.toLowerCase() &&\r\n            appt.status !== \"completed\"\r\n        );\r\n\r\n        setAppointments(userAppointments);\r\n      } catch (err) {\r\n        console.error(\"Error fetching appointments:\", err);\r\n      }\r\n    };\r\n\r\n    fetchAppointments();\r\n  }, []);\r\n\r\n  const formatAppointmentTime = (appt) => {\r\n    if (appt.type === \"normal\" && appt.date && appt.selectedSlot) {\r\n      return `${appt.date}, ${appt.selectedSlot}`;\r\n    } else if (appt.timeSlot) {\r\n      const date = new Date(appt.timeSlot);\r\n      const yyyy = date.getFullYear();\r\n      const mm = String(date.getMonth() + 1).padStart(2, \"0\");\r\n      const dd = String(date.getDate()).padStart(2, \"0\");\r\n\r\n      let hours = date.getHours();\r\n      const minutes = String(date.getMinutes()).padStart(2, \"0\");\r\n      const ampm = hours >= 12 ? \"PM\" : \"AM\";\r\n      hours = hours % 12;\r\n      hours = hours === 0 ? 12 : hours;\r\n      const hh = String(hours).padStart(2, \"0\");\r\n\r\n      return `${yyyy}-${mm}-${dd}, ${hh}:${minutes} ${ampm}`;\r\n    }\r\n    return \"-\";\r\n  };\r\n\r\n  const handleClickOutside = (e) => {\r\n    if (popupRef.current && !popupRef.current.contains(e.target)) {\r\n      setIsOpen(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    document.addEventListener(\"mousedown\", handleClickOutside);\r\n    return () => document.removeEventListener(\"mousedown\", handleClickOutside);\r\n  }, []);\r\n\r\n  const handleToggle = () => {\r\n    setIsOpen((prev) => !prev);\r\n  };\r\n\r\n  const handleViewAll = () => {\r\n    navigate(\"/my-appointments\");\r\n  };\r\n\r\n  return (\r\n    <div className=\"floating-container\" ref={popupRef}>\r\n      <div\r\n        className=\"floating-dot\"\r\n        title=\"View Appointments\"\r\n        onClick={handleToggle}\r\n      ></div>\r\n\r\n      {isOpen && (\r\n        <div className=\"popup-notification\">\r\n          <h4>Upcoming Appointments</h4>\r\n          {appointments.length === 0 ? (\r\n            <p className=\"no-appointments\">\r\n              You have no upcoming appointments.\r\n            </p>\r\n          ) : (\r\n            <>\r\n              {appointments.slice(0, 2).map((appt, index) => (\r\n                <div className=\"appointment-item\" key={index}>\r\n                  <p>\r\n                    <strong>Doctor:</strong> {appt.doctorName}\r\n                  </p>\r\n                  <p>\r\n                    <strong>Speciality:</strong> {appt.doctorSpeciality}\r\n                  </p>\r\n                  <p>\r\n                    <strong>Name:</strong> {appt.name}\r\n                  </p>\r\n                  <p>\r\n                    <strong>Phone:</strong> {appt.phoneNumber}\r\n                  </p>\r\n                  <p>\r\n                    <strong>Time:</strong> {formatAppointmentTime(appt)}\r\n                  </p>\r\n                  {index < Math.min(1, appointments.length - 1) && <hr />}\r\n                </div>\r\n              ))}\r\n              {appointments.length > 2 && (\r\n                <div className=\"view-more\">\r\n                  <button className=\"view-all-btn\" onClick={handleViewAll}>\r\n                    View All\r\n                  </button>\r\n                </div>\r\n              )}\r\n            </>\r\n          )}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Notification;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}